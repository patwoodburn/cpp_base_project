# Use the latest 2.1 version of CircleCI pipeline process engine. See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1
# Orchestrate or schedule a set of jobs
jobs:
  build:
    docker:
    - image: conanio/gcc7:latest
    working_directory: ~/repo/build
    steps:
      - checkout:
          path: ~/repo
      - run: sudo apt update && sudo apt install -y clang cppcheck clang-tidy clang-format
      - run: conan install .. -s compiler.libcxx=libstdc++11 --build=missing
      - run: cmake ..
      - run: cmake --build .
      - run: make cppcheck
      - run: make test
      - run: ls ~/repo/build/Testing
      - run: ls ~/repo/build/Testing/Temporary
      - run: cat ~/repo/build/Testing/Temporary/LastTest.log
      - store_test_results:
          path: ~/repo/build/Testing/Temporary/LastTest.log